# bot.py
import os
import logging
import json  # ‚úÖ –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∏–º–ø–æ—Ä—Ç json –∑–¥–µ—Å—å
from telegram import Update
from telegram.ext import (
    Application,
    CommandHandler,
    MessageHandler,
    filters,
    ConversationHandler,
    ContextTypes,
)
import gspread
from oauth2client.service_account import ServiceAccountCredentials
from openai import OpenAI  # ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∑–¥–µ—Å—å
from datetime import datetime

# –°–ª–æ–≤–∞—Ä—å –∞—Ä—Ö–∏–≤–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–π–ª–∞ "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è 20.06.2024.xlsx"
ARCHIVE_INFO = {
    "–º–æ—Å–∫–≤–∞": {
        "name": "–†–æ—Å—Å–∏–π—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–æ–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ (–†–ì–í–ê)",
        "fund": "—Ñ–æ–Ω–¥ –†-517–ø",
        "docs": "–∞—Ä—Ö–∏–≤–Ω–æ-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –§–°–ë –ø–æ –ú–æ—Å–∫–≤–µ –∏ –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "url": "https://rgvarchive.ru"
    },
    "—Å–∞–Ω–∫—Ç-–ø–µ—Ç–µ—Ä–±—É—Ä–≥": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—É –∏ –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://78.fsb.ru"
    },
    "—Å–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö—Ä—ã–º",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ –±—ã–≤—à–∏—Ö ¬´–æ—Å—Ç–∞—Ä–±–∞–π—Ç–µ—Ä–æ–≤¬ª - –≥—Ä–∞–∂–¥–∞–Ω, —É–≥–Ω–∞–Ω–Ω—ã—Ö –≤ 1942-1944 –≥–≥. –∏–∑ –ö—Ä—ã–º–∞ –Ω–∞ —Ä–∞–±–æ—Ç—ã –≤ –ì–µ—Ä–º–∞–Ω–∏—é",
        "url": "https://kgu-gakk.ru"
    },
    "–∞–¥—ã–≥–µ—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–æ–º—É –∫—Ä–∞—é",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://23.fsb.ru"
    },
    "–∞–ª—Ç–∞–π": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ê–ª—Ç–∞–π",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "http://ga-ra.ru"
    },
    "–±–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω": {
        "name": "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ë–∞—à–∫–æ—Ä—Ç–æ—Å—Ç–∞–Ω",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
        "url": "https://narb-gku.bashkortostan.ru"
    },
    "–±—É—Ä—è—Ç–∏—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ë—É—Ä—è—Ç–∏—è",
        "fund": "—Ñ–æ–Ω–¥ –†-1981",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–∞ –±—ã–≤—à–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö –∏ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–≤–µ—Ç—Å–∫–∏—Ö –≥—Ä–∞–∂–¥–∞–Ω",
        "url": "https://www.na.rkomi.ru"
    },
    "–¥–∞–≥–µ—Å—Ç–∞–Ω": {
        "name": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –î–∞–≥–µ—Å—Ç–∞–Ω",
        "fund": "—Ñ–æ–Ω–¥ –†-1404",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ –±—ã–≤—à–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö (1956-1988 –≥–≥.)",
        "url": "http://cgard.ru"
    },
    "–∏–Ω–≥—É—à–µ—Ç–∏—è": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "–∫–∞–±–∞—Ä–¥–∏–Ω–æ-–±–∞–ª–∫–∞—Ä–∏—è": {
        "name": "–ê—Ä—Ö–∏–≤–Ω–∞—è —Å–ª—É–∂–±–∞ –ö–∞–±–∞—Ä–¥–∏–Ω–æ-–ë–∞–ª–∫–∞—Ä—Å–∫–æ–π –†–µ—Å–ø—É–±–ª–∏–∫–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
        "url": "https://archive.orb.ru"
    },
    "–∫–∞–ª–º—ã–∫–∏—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ö–∞–ª–º—ã–∫–∏—è",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://08.fsb.ru"
    },
    "–∫–∞—Ä–∞—á–∞–µ–≤–æ-—á–µ—Ä–∫–µ—Å–∏—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ö–∞—Ä–∞—á–∞–µ–≤–æ-–ß–µ—Ä–∫–µ—Å—Å–∫–æ–π –†–µ—Å–ø—É–±–ª–∏–∫–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://ga-kchr.ru"
    },
    "–∫–∞—Ä–µ–ª–∏—è": {
        "name": "–£–§–°–ë –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –ö–∞—Ä–µ–ª–∏—è",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://10.fsb.ru"
    },
    "–∫–æ–º–∏": {
        "name": "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö–æ–º–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://nar-komi.ru"
    },
    "–∫—Ä—ã–º": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ö—Ä—ã–º",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ –±—ã–≤—à–∏—Ö ¬´–æ—Å—Ç–∞—Ä–±–∞–π—Ç–µ—Ä–æ–≤¬ª",
        "url": "https://kgu-gakk.ru"
    },
    "–º–∞—Ä–∏–π —ç–ª": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ú–∞—Ä–∏–π –≠–ª",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ (1945-1960 –≥–≥.)",
        "url": "https://ga-mo.ru"
    },
    "–º–æ—Ä–¥–æ–≤–∏—è": {
        "name": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –ú–æ—Ä–¥–æ–≤–∏—è",
        "fund": "—Ñ–æ–Ω–¥ –†-3235",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞, —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏, —Å–ø–∏—Å–∫–∏ —Ä–µ–ø–∞—Ç—Ä–∏–∞–Ω—Ç–æ–≤",
        "url": "https://cgarm.mordovia.gov.ru"
    },
    "—Å–∞—Ö–∞": {
        "name": "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –°–∞—Ö–∞ (–Ø–∫—É—Ç–∏—è)",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://nar-sakha.ru"
    },
    "—Å–µ–≤–µ—Ä–Ω–∞—è –æ—Å–µ—Ç–∏—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –†–µ—Å–ø—É–±–ª–∏–∫–µ –°–µ–≤–µ—Ä–Ω–∞—è –û—Å–µ—Ç–∏—è-–ê–ª–∞–Ω–∏—è",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://15.fsb.ru"
    },
    "—Ç–∞—Ç–∞—Ä—Å—Ç–∞–Ω": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –¢–∞—Ç–∞—Ä—Å—Ç–∞–Ω",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://ga.tatarstan.ru"
    },
    "—Ç—ã–≤–∞": {
        "name": "–ù–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞—Ä—Ö–∏–≤ –†–µ—Å–ø—É–±–ª–∏–∫–∏ –¢—ã–≤–∞",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://nar-tuva.ru"
    },
    "—É–¥–º—É—Ä—Ç–∏—è": {
        "name": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –£–¥–º—É—Ä—Ç—Å–∫–æ–π –†–µ—Å–ø—É–±–ª–∏–∫–∏",
        "fund": "—Ñ–æ–Ω–¥ –†-461",
        "docs": "—É—á–µ—Ç–Ω—ã–µ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ª–∏—Ü, –ø—Ä–æ—à–µ–¥—à–∏—Ö —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é",
        "url": "https://cgau.ru"
    },
    "—Ö–∞–∫–∞—Å–∏—è": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "—á–µ—á–µ–Ω—Å–∫–∞—è": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "—á—É–≤–∞—à—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞—Ä—Ö–∏–≤ –ß—É–≤–∞—à—Å–∫–æ–π –†–µ—Å–ø—É–±–ª–∏–∫–∏",
        "fund": "—Ñ–æ–Ω–¥ –†-2669",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://giachr.cap.ru"
    },
    "–∞–ª—Ç–∞–π—Å–∫–∏–π": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ê–ª—Ç–∞–π—Å–∫–æ–≥–æ –∫—Ä–∞—è",
        "fund": "—Ñ–æ–Ω–¥ –†-2000",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
        "url": "https://ga-altai.ru"
    },
    "–∑–∞–±–∞–π–∫–∞–ª—å—Å–∫–∏–π": {
        "name": "—Å–º. –ß–∏—Ç–∏–Ω—Å–∫—É—é –æ–±–ª–∞—Å—Ç—å –∏ –†–µ—Å–ø—É–±–ª–∏–∫—É –ë—É—Ä—è—Ç–∏—è",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "–∫–∞–º—á–∞—Ç—Å–∫–∏–π": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ö–∞–º—á–∞—Ç—Å–∫–æ–≥–æ –∫—Ä–∞—è",
        "fund": "—Ñ–æ–Ω–¥ –ü-1199",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://gakpk.ru"
    },
    "–∫—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–∏–π": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä—Å–∫–æ–º—É –∫—Ä–∞—é",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://23.fsb.ru"
    },
    "–∫—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–∏–π": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ö—Ä–∞—Å–Ω–æ—è—Ä—Å–∫–æ–≥–æ –∫—Ä–∞—è",
        "fund": "—Ñ–æ–Ω–¥ –†-2400",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://krasnoyarsk-archives.ru"
    },
    "—Å—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–∏–π": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –Ω–æ–≤–µ–π—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –°—Ç–∞–≤—Ä–æ–ø–æ–ª—å—Å–∫–æ–≥–æ –∫—Ä–∞—è",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ 6222",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞, —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã",
        "url": "https://sagd.ru"
    },
    "—Ö–∞–±–∞—Ä–æ–≤—Å–∫–∏–π": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –û–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://56.fsb.ru"
    },
    "–∞–º—É—Ä—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –û–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://56.fsb.ru"
    },
    "–∞—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–∞—è": [
        {
            "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
            "url": "https://29.fsb.ru"
        },
        {
            "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –£–ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –ê—Ä—Ö–∞–Ω–≥–µ–ª—å—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "–∂—É—Ä–Ω–∞–ª —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≥—Ä–∞–∂–¥–∞–Ω –∏ –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
            "url": "https://08.mvd.ru"
        }
    ],
    "–∞—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ê—Å—Ç—Ä–∞—Ö–∞–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-827",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ –±—ã–≤—à–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
        "url": "https://archiv30.ru"
    },
    "–±–µ–ª–≥–æ—Ä–æ–¥—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –Ω–æ–≤–µ–π—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –ë–µ–ª–≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ 2098",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
        "url": "https://ganibo.ru"
    },
    "–±—Ä—è–Ω—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ë—Ä—è–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://32.fsb.ru"
    },
    "–≤–ª–∞–¥–∏–º–∏—Ä—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –í–ª–∞–¥–∏–º–∏—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-606",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ —Å–æ–≤–µ—Ç—Å–∫–∏—Ö –≥—Ä–∞–∂–¥–∞–Ω, –±—ã–≤—à–∏—Ö –≤ –ø–ª–µ–Ω—É",
        "url": "https://gosarhiv33.ru"
    },
    "–≤–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–∞—è": {
        "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ì–£ –ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –í–æ–ª–≥–æ–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Å–ø–∏—Å–∫–∏ –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö, –ø—Ä–æ—à–µ–¥—à–∏—Ö –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –°—Ç–∞–ª–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º –ª–∞–≥–µ—Ä–µ",
        "url": "https://34.mvd.ru"
    },
    "–≤–æ–ª–æ–≥–æ–¥—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –í–æ–ª–æ–≥–æ–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –±—ã–≤—à–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
        "url": "https://35.fsb.ru"
    },
    "–≤–æ—Ä–æ–Ω–µ–∂—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ-–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –í–æ—Ä–æ–Ω–µ–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ 9353",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –∏ –∫–∞—Ä—Ç–æ—á–∫–∏ –±—ã–≤—à–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
        "url": "https://archive74.ru"
    },
    "–∏–≤–∞–Ω–æ–≤—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ò–≤–∞–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://gaiio.ru"
    },
    "–∏—Ä–∫—É—Ç—Å–∫–∞—è": {
        "name": "–¶–µ–Ω—Ç—Ä –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –Ω–æ–≤–µ–π—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî —Ñ–∏–ª–∏–∞–ª –û–ì–ö–£ ¬´–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ò—Ä–∫—É—Ç—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏¬ª",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://tdni.irkutsk.ru"
    },
    "–∫–∞–ª–∏–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "–∫–∞–ª—É–∂—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ö–∞–ª—É–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://archiv40.ru"
    },
    "–∫–µ–º–µ—Ä–æ–≤—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ö—É–∑–±–∞—Å—Å–∞",
        "fund": "—Ñ–æ–Ω–¥ –†-1243",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–æ–Ω–¥ –£–ø—Ä–∞–≤–ª–µ–Ω–∏—è –§–°–ë –†–§ –ø–æ –ö–µ–º–µ—Ä–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "url": "https://gak-kemerovo.ru"
    },
    "–∫–∏—Ä–æ–≤—Å–∫–∞—è": [
        {
            "name": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ö–∏—Ä–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
            "url": "https://cgako.ru"
        },
        {
            "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –£–ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –ö–∏—Ä–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "–¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü",
            "url": "https://43.mvd.ru"
        }
    ],
    "–∫–æ—Å—Ç—Ä–æ–º—Å–∫–∞—è": [
        {
            "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –Ω–æ–≤–µ–π—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –ö–æ—Å—Ç—Ä–æ–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-3656",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ —Ä–µ–ø–∞—Ç—Ä–∏–∞–Ω—Ç–æ–≤ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
            "url": "https://ganiko.ru"
        },
        {
            "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –£–ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –ö–æ—Å—Ç—Ä–æ–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "–æ—Ç—á–µ—Ç—ã –ø–æ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º",
            "url": "https://44.mvd.ru"
        }
    ],
    "–∫—É—Ä–≥–∞–Ω—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ —Å–æ—Ü–∏–∞–ª—å–Ω–æ-–ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ö—É—Ä–≥–∞–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ 6905",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://ga45.ru"
    },
    "–ö—É—Ä—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ö—É—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://46.fsb.ru"
    },
    "–ª–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—É –∏ –õ–µ–Ω–∏–Ω–≥—Ä–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://78.fsb.ru"
    },
    "–ª–∏–ø–µ—Ü–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –õ–∏–ø–µ—Ü–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://48.fsb.ru"
    },
    "–º–∞–≥–∞–¥–∞–Ω—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –û–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://56.fsb.ru"
    },
    "–º–æ—Å–∫–æ–≤—Å–∫–∞—è": [
        {
            "name": "–†–æ—Å—Å–∏–π—Å–∫–∏–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–æ–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ (–†–ì–í–ê)",
            "fund": "—Ñ–æ–Ω–¥ –†-517–ø",
            "docs": "–∞—Ä—Ö–∏–≤–Ω–æ-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
            "url": "https://rgvarchive.ru"
        },
        {
            "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ì–£ –ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –ú–æ—Å–∫–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "—Å–≤–µ–¥–µ–Ω–∏—è –æ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö",
            "url": "https://50.mvd.ru"
        }
    ],
    "–º—É—Ä–º–∞–Ω—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ú—É—Ä–º–∞–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-140",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞, —Å–ø–∏—Å–∫–∏ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–æ–≤–µ—Ç—Å–∫–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö, —Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
        "url": "https://www.murmanarchiv.ru"
    },
    "–Ω–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∞—è": {
        "name": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞—Ä—Ö–∏–≤ –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-2209",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ —Å–æ–≤–µ—Ç—Å–∫–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
        "url": "https://arch.nnov.ru"
    },
    "–Ω–æ–≤–≥–æ—Ä–æ–¥—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ù–æ–≤–≥–æ—Ä–æ–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-4541",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://gosarhiv53.ru"
    },
    "–Ω–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-208",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://arch.nsk.ru"
    },
    "–æ–º—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –û–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://56.fsb.ru"
    },
    "–æ—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è": [
        {
            "name": "–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞, –Ω–µ–º–µ—Ü–∫–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏",
            "url": "https://archiv56.ru"
        },
        {
            "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –£–ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "–æ—Ç—á–µ—Ç—ã –ø–æ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã–º",
            "url": "https://56.mvd.ru"
        }
    ],
    "–æ—Ä–ª–æ–≤—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –û—Ä–ª–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://gaoor.ru"
    },
    "–ø–µ–Ω–∑–µ–Ω—Å–∫–∞—è": [
        {
            "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ü–µ–Ω–∑–µ–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "—Ñ–æ–Ω–¥ ‚Ññ –†-889",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö –∑–∞ 1945-1947 –≥–≥.",
            "url": "https://arhivpnz.ru"
        },
        {
            "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ü–µ–Ω–∑–µ–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–∫–∞—Ä—Ç–æ—Ç–µ–∫–∏ —Ñ–æ–Ω–¥–∞",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
            "url": "https://58.fsb.ru"
        }
    ],
    "–ø—Å–∫–æ–≤—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ü—Å–∫–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://60.fsb.ru"
    },
    "—Ä–æ—Å—Ç–æ–≤—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –†–æ—Å—Ç–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://61.fsb.ru"
    },
    "—Ä—è–∑–∞–Ω—Å–∫–∞—è": [
        {
            "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –†—è–∑–∞–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
            "url": "https://62.fsb.ru"
        },
        {
            "name": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –£–ú–í–î –†–æ—Å—Å–∏–∏ –ø–æ –†—è–∑–∞–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
            "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
            "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏",
            "url": "https://62.mvd.ru"
        }
    ],
    "—Å–∞–º–∞—Ä—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –°–∞–º–∞—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://63.fsb.ru"
    },
    "—Å–∞—Ä–∞—Ç–æ–≤—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –Ω–æ–≤–µ–π—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏ –°–∞—Ä–∞—Ç–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ 6210",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ –±—ã–≤—à–∏—Ö —Å–æ–≤–µ—Ç—Å–∫–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
        "url": "https://ganiso.ru"
    },
    "—Å–∞—Ö–∞–ª–∏–Ω—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∞—Ä—Ö–∏–≤ –°–∞—Ö–∞–ª–∏–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ ‚Ññ 1174",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://saharchive.ru"
    },
    "—Å–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤ –°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ –†-1",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-—Ç—Ä–æ—Ñ–µ–π–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã",
        "url": "https://gaao66.ru"
    },
    "—Å–º–æ–ª–µ–Ω—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –°–º–æ–ª–µ–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://67.fsb.ru"
    },
    "—Ç–∞–º–±–æ–≤—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –¢–∞–º–±–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ –†-5306",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ –∑–∞ 1945-1984 –≥–≥.",
        "url": "https://tambovarchiv.ru"
    },
    "—Ç–≤–µ—Ä—Å–∫–∞—è": {
        "name": "–¢–¶–î–ù–ò –¢–≤–µ—Ä—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ –†-1011",
        "docs": "–¥–µ–ª–∞ –±—ã–≤—à–∏—Ö –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö",
        "url": "http://tcdni.tverreg.ru"
    },
    "—Ç–æ–º—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –¢–æ–º—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "—Ñ–æ–Ω–¥ –†-208",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "http://gato.tomica.ru"
    },
    "—Ç—É–ª—å—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –¢—É–ª—å—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://71.fsb.ru"
    },
    "—É–ª—å—è–Ω–æ–≤—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –£–ª—å—è–Ω–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://73.fsb.ru"
    },
    "—á–µ–ª—è–±–∏–Ω—Å–∫–∞—è": {
        "name": "–£–§–°–ë –†–æ—Å—Å–∏–∏ –ø–æ –ß–µ–ª—è–±–∏–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://74.fsb.ru"
    },
    "—è–º–∞–ª–æ-–Ω–µ–Ω–µ—Ü–∫–∏–π": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "—Ö–∞–Ω—Ç—ã-–º–∞–Ω—Å–∏–π—Å–∫–∏–π": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "—á—É–∫–æ—Ç—Å–∫–∏–π": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "–¥–æ–Ω–µ—Ü–∫–∞—è": {
        "name": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "fund": "",
        "docs": "",
        "url": ""
    },
    "–ª—É–≥–∞–Ω—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏–≤–Ω–∞—è —Å–ª—É–∂–±–∞ –õ—É–≥–∞–Ω—Å–∫–æ–π –ù–∞—Ä–æ–¥–Ω–æ–π –†–µ—Å–ø—É–±–ª–∏–∫–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ –∑–∞ 1941-1946 –≥–æ–¥—ã",
        "url": "https://arch.lpr-reg.ru"
    },
    "—Ö–µ—Ä—Å–æ–Ω—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –•–µ—Ä—Å–æ–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞",
        "url": "https://rgvarchive.ru"
    },
    "–∑–∞–ø–æ—Ä–æ–∂—Å–∫–∞—è": {
        "name": "–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω—ã–π –∞—Ä—Ö–∏–≤ –ó–∞–ø–æ—Ä–æ–∂—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
        "fund": "–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö",
        "docs": "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ–ª–∞ –Ω–∞ –≥—Ä–∞–∂–¥–∞–Ω, –≤—ã–≤–µ–∑–µ–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –≤ –ì–µ—Ä–º–∞–Ω–∏—é",
        "url": "https://zaporizhzhia-archives.gov.ua"
    }
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(format='%(asctime)s - %(name)s - %(levelname)s - %(message)s', level=logging.INFO)
logger = logging.getLogger(__name__)

# –°–æ—Å—Ç–æ—è–Ω–∏—è –∞–Ω–∫–µ—Ç—ã
STEP_FIO, STEP_DATES, STEP_REGION, STEP_KNOWN, STEP_GOAL, STEP_CONTACT = range(6)

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–µ–π—Å–∞
def classify_case(text):
    text = text.lower()
    if any(k in text for k in ["–∞—Ä–µ—Å—Ç–æ–≤–∞–Ω", "—Ä–∞—Å—Å—Ç—Ä–µ–ª—è–Ω", "—Ä–µ–∞–±–∏–ª–∏—Ç–∏—Ä–æ–≤–∞–Ω", "—Ç—Ä–æ–π–∫–∞", "–Ω–∫–≤–¥", "–∫-—Ä", "—à–ø–∏–æ–Ω"]):
        return "—Ä–µ–ø—Ä–µ—Å—Å–∏–∏"
    elif any(k in text for k in ["–ø–ª–µ–Ω", "—à—Ç–∞–ª–∞–≥", "–æ—Ñ–ª–∞–≥", "arolsen", "wast", "–≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã–π"]):
        return "–ø–ª–µ–Ω"
    elif any(k in text for k in ["–æ—Å—É–∂–¥—ë–Ω", "—É–≥–æ–ª–æ–≤–Ω–æ–µ –¥–µ–ª–æ", "—Å—Ä–æ–∫", "—Ç—é—Ä—å–º–∞", "–º—É—Ä–º–∞—à–∏"]):
        return "–æ—Å—É–∂–¥—ë–Ω"
    elif any(k in text for k in ["–∫—É–ª–∞–∫", "—Ä–∞—Å–∫—É–ª–∞—á–µ–Ω—ã", "—Å–ø–µ—Ü–ø–µ—Ä–µ—Å–µ–ª–µ–Ω–∏–µ"]):
        return "—Ä–∞—Å–∫—É–ª–∞—á–µ–Ω–Ω—ã–µ"
    elif any(k in text for k in ["–≤–Ω–µ–±—Ä–∞—á–Ω—ã–π", "–Ω–µ –±—ã–ª –∂–µ–Ω–∞—Ç", "–æ—Ç—Ü–æ–≤—Å—Ç–≤–æ", "—Ä–æ–¥–∏–ª—Å—è –æ—Ç"]):
        return "–≤–Ω–µ–±—Ä–∞—á–Ω–æ–µ"
    elif "—Ä–æ–¥–æ—Å–ª–æ–≤–Ω–∞—è" in text or "–ø—Ä–µ–¥–∫–∏" in text:
        return "—Ä–æ–¥–æ—Å–ª–æ–≤–Ω–∞—è"
    else:
        return "–æ–±—â–∏–π"

def get_archive_recommendation(region: str, known: str) -> str:
    """
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –ø–æ –∞—Ä—Ö–∏–≤—É, –µ—Å–ª–∏ –ø—Ä–µ–¥–æ–∫ –±—ã–ª –≤ –ø–ª–µ–Ω—É.
    """
    # –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞, —É–∫–∞–∑—ã–≤–∞—é—â–∏–µ –Ω–∞ –ø–ª–µ–Ω
    keywords = ["–ø–ª–µ–Ω", "—Ä–µ–ø–∞—Ç—Ä–∏", "–æ—Å—Ç–∞—Ä–±–∞–π—Ç–µ—Ä", "—Ñ–∏–ª—å—Ç—Ä–∞—Ü", "–ø—Ä–æ–≤–µ—Ä–∫–∞", 
                "–≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω", "—É–≥–Ω–∞–Ω", "—Ç—Ä—É–¥–∞—Ä–º–∏—è", "–ª–∞–≥–µ—Ä—å", "–¥–æ–ø—Ä–æ—Å", "–ª–∞–≥–µ—Ä", "–¥–æ–ø—Ä–æ—Å", "—Å–ª–µ–¥—Å—Ç–≤–∏–µ"]
    
    if not any(k in known.lower() for k in keywords):
        return ""

    region_lower = region.lower().strip()

    # –ü–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–∞–º —Å–ª–æ–≤–∞—Ä—è
    for key, info in ARCHIVE_INFO.items():
        if key in region_lower:
            return (
                f"\n\nüîç –î–ª—è –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö –∏ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö:\n"
                f"‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤: {info['name']}\n"
                f"‚Ä¢ –§–æ–Ω–¥: {info['fund']}\n"
                f"‚Ä¢ –¢–∏–ø –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: {info['docs']}\n"
                f"‚Ä¢ –°–∞–π—Ç: {info['url']}\n"
                f"‚Ä¢ –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —É–∫–∞–∂–∏—Ç–µ: —Ñ–∞–º–∏–ª–∏—é, –¥–∞—Ç—ã, –º–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ —Ñ–∞–∫—Ç –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è –≤ –ø–ª–µ–Ω—É"
            )
    # –ï—Å–ª–∏ —Ä–µ–≥–∏–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω
    return (
        "\n\nüîç –î–ª—è –≤–æ–µ–Ω–Ω–æ–ø–ª–µ–Ω–Ω—ã—Ö:\n"
        "‚Ä¢ –£—Ç–æ—á–Ω–∏—Ç–µ —Ä–µ–≥–∏–æ–Ω –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–µ–¥–∫–∞ ‚Äî –≤ –±–∞–∑–µ –Ω–µ—Ç —Ç–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö\n"
        "‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –≤ –£–§–°–ë –∏–ª–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–µ–Ω—Ç—Ä –ú–í–î –ø–æ —Ä–µ–≥–∏–æ–Ω—É"
    )
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üëã –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø ‚Äî –±–æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ Rodoslovnaya.pro.\n"
        "–ü–æ–¥–≥–æ—Ç–æ–≤–ª—é –¥–ª—è –í–∞—Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—É–¥—å–±–µ –í–∞—à–∏—Ö –ø—Ä–µ–¥–∫–æ–≤ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –∏ –∞—Ä—Ö–∏–≤–∞–º.\n"
        "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ –ø—Ä–µ–¥–∫–µ, —á—å—é –∏—Å—Ç–æ—Ä–∏—é –í—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å.\n\n"
        "üìå –ù–∞—á–Ω—ë–º —Å –§–ò–û –ø—Ä–µ–¥–∫–∞:"
    )
    return STEP_FIO

async def handle_fio(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["fio"] = update.message.text
    await update.message.reply_text("üìÖ –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –≥–æ–¥—ã –∂–∏–∑–Ω–∏ –ø—Ä–µ–¥–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1890‚Äì1942):")
    return STEP_DATES

async def handle_dates(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["dates"] = update.message.text
    await update.message.reply_text(
    "üìç –ì–¥–µ –∂–∏–ª –ø—Ä–µ–¥–æ–∫? –£–∫–∞–∂–∏—Ç–µ:\n"
    "‚Ä¢ –ú–µ—Å—Ç–æ —Ä–æ–∂–¥–µ–Ω–∏—è (–¥–µ—Ä–µ–≤–Ω—è, —Å–µ–ª–æ, –≥–æ—Ä–æ–¥)\n"
    "‚Ä¢ –ì–¥–µ –ø—Ä–æ–∂–∏–≤–∞–ª\n"
    "‚Ä¢ –ì–¥–µ —É–º–µ—Ä –∏ –ø–æ—Ö–æ—Ä–æ–Ω–µ–Ω (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ)\n\n"
    "–ü—Ä–∏–º–µ—Ä: —Ä–æ–¥–∏–ª—Å—è –ü–µ—Ç—Ä–æ–≤–æ, –†—è–∑–∞–Ω—Å–∫–∞—è –æ–±–ª., –∑–∞—Ç–µ–º –û—Ä–µ–Ω–±—É—Ä–≥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å, —É–º–µ—Ä –≤ –ê–ª–µ–∫—Å–∏–Ω–µ –¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å"
)
    return STEP_REGION

async def handle_region(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["region"] = update.message.text
    await update.message.reply_text(
    "üìö –ß—Ç–æ –í—ã —É–∂–µ –∑–Ω–∞–µ—Ç–µ –æ –ø—Ä–µ–¥–∫–µ?\n"
    "–£–∫–∞–∂–∏—Ç–µ –≤—Å—ë, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏ –≤ —Å–µ–º—å–µ:\n"
    "‚Ä¢ –ü—Ä–æ—Ñ–µ—Å—Å–∏—è, –≤–æ–µ–Ω–Ω–∞—è —Å–ª—É–∂–±–∞\n"
    "‚Ä¢ –°—É–¥—å–±–∞ –≤ –≤–æ–π–Ω—É, —Ä–µ–ø—Ä–µ—Å—Å–∏–∏, –ø–ª–µ–Ω\n"
    "‚Ä¢ –†–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ (–æ—Ç–µ—Ü, –º–∞—Ç—å ‚Äî –ø–æ –∏–º–µ–Ω–∏-–æ—Ç—á–µ—Å—Ç–≤—É)\n"
    "‚Ä¢ –ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ —Ñ–∞–∫—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–¥–µ–ª–∞–ª –≤–æ–ª–æ–∫—É—à–∏¬ª, ¬´–∫–∞–ø–∏—Ç–∞–Ω —Å –ö—Ä–æ–Ω—à—Ç–∞–¥—Ç–∞¬ª)"
)
    return STEP_KNOWN

async def handle_known(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["known"] = update.message.text
    await update.message.reply_text(
    "üéØ –ß—Ç–æ –±—ã –í—ã —Ö–æ—Ç–µ–ª–∏ —É–∑–Ω–∞—Ç—å –æ –ø—Ä–µ–¥–∫–µ –∏ –µ–≥–æ —Ñ–∞–º–∏–ª—å–Ω–æ–º —Ä–æ–¥–µ?\n"
    "–í—ã–±–µ—Ä–∏—Ç–µ –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ:\n"
    "‚Ä¢ –ö—Ç–æ –±—ã–ª–∏ –µ–≥–æ —Ä–æ–¥–∏—Ç–µ–ª–∏?\n"
    "‚Ä¢ –ì–¥–µ –æ–Ω —Ä–æ–¥–∏–ª—Å—è –∏ –≥–¥–µ –ø–æ—Ö–æ—Ä–æ–Ω–µ–Ω?\n"
    "‚Ä¢ –ö–∞–∫–æ–≤–∞ –±—ã–ª–∞ –µ–≥–æ —Å—É–¥—å–±–∞ –≤ –≤–æ–π–Ω—É –∏–ª–∏ –≤ —Ä–µ–ø—Ä–µ—Å—Å–∏—è—Ö?\n"
    "‚Ä¢ –ò–∑ –∫–∞–∫–æ–≥–æ –æ–Ω —Ä–æ–¥–∞, –µ—Å—Ç—å –ª–∏ –±–æ–ª–µ–µ —Ä–∞–Ω–Ω–∏–µ –ø—Ä–µ–¥–∫–∏?\n"
    "‚Ä¢ –ß—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç –µ–≥–æ –ø–æ–¥–≤–∏–≥ –∏–ª–∏ —Ç—Ä—É–¥–æ–≤–æ–π –ø—É—Ç—å?"
)
    return STEP_GOAL

async def handle_goal(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["goal"] = update.message.text
    await update.message.reply_text("üì¨ –û—Å—Ç–∞–≤—å—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, Telegram –∏–ª–∏ email –¥–ª—è —Å–≤—è–∑–∏:")
    return STEP_CONTACT

async def handle_contact(update: Update, context: ContextTypes.DEFAULT_TYPE):
    context.user_data["contact"] = update.message.text
    data = context.user_data
    case_type = classify_case(f"{data['known']} {data['goal']}")
    data["case_type"] = case_type
    
    await update.message.reply_text(
    "‚è≥ <b> üîç –°–ø–∞—Å–∏–±–æ –∑–∞ –∞–Ω–∫–µ—Ç—É!</b>\n"
    "üß† Rodoslovnaya.pro –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –∞—Ä—Ö–∏–≤–∞–º –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º‚Ä¶\n"
    "–ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ ‚Äî —Å–∫–æ—Ä–æ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω –ø–æ–∏—Å–∫–∞.",
    parse_mode="HTML"
)
    await update.message.reply_chat_action("typing")
   
# –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –ø–æ –∞—Ä—Ö–∏–≤—É
archive_context = get_archive_recommendation(data['region'], data['known'])

    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç –¥–ª—è OpenAI
prompt = f"""
–°–æ—Å—Ç–∞–≤—å –ø–æ—à–∞–≥–æ–≤—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–¥–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö:

üìå –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
–§–ò–û: {data['fio']}
–ì–æ–¥—ã –∂–∏–∑–Ω–∏: {data['dates']}
–ú–µ—Å—Ç–æ: {data['region']}
–ò–∑–≤–µ—Å—Ç–Ω–æ: {data['known']}
–¶–µ–ª—å: {data['goal']}

üß† –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –æ—Ç Rodoslovnaya.pro:

–û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω –∫–∞–∫: "üìå –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ", "üîç –ü–û–®–ê–ì–û–í–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø", "‚úÖ –ß–µ–∫-–ª–∏—Å—Ç", "üì¨ –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?"
- –° —É–∫–∞–∑–∞–Ω–∏–µ–º **–≥–ª—É–±–∏–Ω—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**: –ó–ê–ì–°—ã (—Å 1920-—Ö –ø–æ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è), –º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∫–Ω–∏–≥–∏ (c 1700 –¥–æ 1917), —Ä–µ–≤–∏–∑—Å–∫–∏–µ —Å–∫–∞–∑–∫–∏ (c 1700 –¥–æ 1858), –∏—Å–ø–æ–≤–µ–¥–Ω—ã–µ –≤–µ–¥–æ–º–æ—Å—Ç–∏ (c 1700 –¥–æ 1880-—Ö), –¥–∞–Ω–Ω—ã–µ —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–æ–π –ø–µ—Ä–µ–ø–∏—Å–∏ 1916 –≥–æ–¥–∞, –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–æ–±—â–µ–π –ø–µ—Ä–µ–ø–∏—Å—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è 1897
- –° **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏** –Ω–∞ –∞—Ä—Ö–∏–≤—ã, –ó–ê–ì–°—ã, –æ–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã (–Ω–µ –æ–±—â–∏–µ, –∞ —Ç–æ—á–Ω—ã–µ: https://obd-memorial.ru, https://pamyat-naroda.ru, https://arolsen-archives.org, https://forum.vgd.ru/, https://yandex.ru/archive )
- –° **—Ç–æ—á–Ω—ã–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ –∞—Ä—Ö–∏–≤–∞–º**:
  ‚Ä¢ –ï—Å–ª–∏ –ø—Ä–µ–¥–æ–∫ –±—ã–ª –≤ –ø–ª–µ–Ω—É –∏–ª–∏ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω ‚Äî —É–∫–∞–∂–∏ **–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∞—Ä—Ö–∏–≤ –ø–æ —Ä–µ–≥–∏–æ–Ω—É** (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ì–æ—Å–∞—Ä—Ö–∏–≤ –ú—É—Ä–º–∞–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏, —Ñ–æ–Ω–¥ –†-140)
  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è 20.06.2024.xlsx"
  ‚Ä¢ –£–∫–∞–∂–∏: "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ-–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –¥–µ–ª–∞", "—Ç–∞–±–µ–ª—å–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏", "—Å–ø–∏—Å–∫–∏ —Ä–µ–ø–∞—Ç—Ä–∏–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö"
- –° **–ø—Ä–∏–º–µ—Ä–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ó–ê–ì–° ‚Äî 350‚Äì400 ‚ÇΩ, –∞—Ä—Ö–∏–≤ ‚Äî –æ—Ç 500 ‚ÇΩ)
- –° —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π –ø–æ **–î–ù–ö-—Ç–µ—Å—Ç—É (Genotek, MyHeritage)** –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤
- –ë–µ–∑ –æ–±—â–∏—Ö —Ñ—Ä–∞–∑ ‚Äî —Ç–æ–ª—å–∫–æ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞
- –ù–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ

{archive_context}
    """

    try:
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞
        api_key = os.getenv("OPENAI_API_KEY")
        if not api_key:
            raise EnvironmentError("OPENAI_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω!")

        client = OpenAI(api_key=api_key)

        completion = client.chat.completions.create(
            model="gpt-3.5-turbo",
            messages=[
                {"role": "system", "content": "–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≥–µ–Ω–µ–∞–ª–æ–≥. –ü–∏—à–∏ —á—ë—Ç–∫–æ, –ø–æ –¥–µ–ª—É, —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏, —Ç–∞—Ä–∏—Ñ–∞–º–∏ –∏ —Å—Å—ã–ª–∫–∞–º–∏. –ù–µ –¥–æ–±–∞–≤–ª—è–π –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è ‚Äî –Ω–∞—á–∏–Ω–∞–π —Å—Ä–∞–∑—É —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è."},
                {"role": "user", "content": prompt}
            ],
            max_tokens=1500,
            temperature=0.7
        )
        ai_response = completion.choices[0].message.content.strip()

        # –§–æ—Ä–º–∏—Ä—É–µ–º –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç–≤–µ—Ç
        response = f"""üß† Rodoslovnaya.PRO —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç:

{ai_response}

üì¨ –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?
–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ —Å–∞–π—Ç–µ rodoslovnaya.pro,
–Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –Ω–∞ predki@rodoslovnaya.pro
–∏–ª–∏ –≤ Telegram @rodoslovnaya_pro"""

    except Exception as e:
        response = f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–≤–µ—Ç–∞: {str(e)}\n\n–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞–º –Ω–∞–ø—Ä—è–º—É—é."

    # ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç (–≤—Å—ë –µ—â—ë –≤–Ω—É—Ç—Ä–∏ handle_contact)
    await update.message.reply_text(response)

    # ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É
    save_to_google_sheets({
        "fio": data.get("fio"),
        "dates": data.get("dates"),
        "region": data.get("region"),
        "known": data.get("known"),
        "goal": data.get("goal"),
        "contact": data.get("contact"),
        "case_type": case_type,
        "recommendations": response
    })

    return ConversationHandler.END

def save_to_google_sheets(data):
    try:
        print("‚úÖ 1. –ù–∞—á–∏–Ω–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Google –¢–∞–±–ª–∏—Ü—É...")
        scope = [
            "https://spreadsheets.google.com/feeds",
            "https://www.googleapis.com/auth/drive"
        ]  # ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: —É–±—Ä–∞–Ω—ã –ø—Ä–æ–±–µ–ª—ã
        
        json_creds = os.getenv("GOOGLE_CREDENTIALS")
        if not json_creds:
            raise EnvironmentError("–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è GOOGLE_CREDENTIALS –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")
        
        creds_dict = json.loads(json_creds)
        print("‚úÖ 2. JSON —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω")

        creds = ServiceAccountCredentials.from_json_keyfile_dict(creds_dict, scope)
        print("‚úÖ 3. –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã")

        client = gspread.authorize(creds)
        print("‚úÖ 4. –ü–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ Google Sheets API")

        sheet = client.open_by_url(os.getenv("GOOGLE_SHEET_URL")).sheet1
        print("‚úÖ 5. –ü–æ–¥–∫–ª—é—á–∏–ª–∏—Å—å –∫ —Ç–∞–±–ª–∏—Ü–µ")

        row = [
            datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            data.get("fio"),
            data.get("dates"),
            data.get("region"),
            data.get("known"),
            data.get("goal"),
            data.get("contact"),
            data.get("case_type"),
            data.get("recommendations")
        ]
        sheet.append_row(row)
        print("‚úÖ 6. –î–ê–ù–ù–´–ï –£–°–ü–ï–®–ù–û –î–û–ë–ê–í–õ–ï–ù–´ –í –¢–ê–ë–õ–ò–¶–£!")
    except Exception as e:
        print(f"‚ùå –û–®–ò–ë–ö–ê –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: {e}")

def main():
    TOKEN = os.getenv("TELEGRAM_TOKEN")
    if not TOKEN:
        logger.error("–¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω! –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é TELEGRAM_TOKEN")
        return
    # üîΩ –î–û–ë–ê–í–¨ –°–Æ–î–ê –ü–†–ò–ù–¢ üîΩ
    print(f"TELEGRAM_TOKEN: {'–î–∞, –µ—Å—Ç—å' if TOKEN else '–ù–µ—Ç!'}")
    print(f"OPENAI_API_KEY: {os.getenv('OPENAI_API_KEY')}")
    print(f"GOOGLE_SHEET_URL: {os.getenv('GOOGLE_SHEET_URL')}")
    # üîº –î–û–ë–ê–í–¨ –°–Æ–î–ê –ü–†–ò–ù–¢ üîº

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenAI API Key
    api_key = os.getenv("OPENAI_API_KEY")
    if not api_key:
        logger.error("OPENAI_API_KEY –Ω–µ –Ω–∞–π–¥–µ–Ω! –ë–æ—Ç –Ω–µ —Å–º–æ–∂–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–æ–≤–µ—Ç—ã.")
        return
        
    # –°–æ–∑–¥–∞—ë–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–∏–∞–ª–æ–≥–∞
    conv_handler = ConversationHandler(
        entry_points=[CommandHandler("start", start)],
        states={
            STEP_FIO: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_fio)],
            STEP_DATES: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_dates)],
            STEP_REGION: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_region)],
            STEP_KNOWN: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_known)],
            STEP_GOAL: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_goal)],
            STEP_CONTACT: [MessageHandler(filters.TEXT & ~filters.COMMAND, handle_contact)],
        },
        fallbacks=[]
    )

    # –°–æ–∑–¥–∞—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    app = (
        Application.builder()
        .token(TOKEN)
        .read_timeout(30)
        .write_timeout(30)
        .connect_timeout(30)
        .pool_timeout(30)
        .build()
    )

    # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    app.add_handler(conv_handler)

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    app.run_polling()

# ‚úÖ –ó–∞–ø—É—Å–∫–∞–µ–º main()
if __name__ == "__main__":
    main()
